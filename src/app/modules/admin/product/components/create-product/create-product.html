<p-dialog header="Create product" [modal]="true" [(visible)]="visible" [style]="{ width: '35rem' }"
  [closable]="false">
  <span class="p-text-secondary block mb-8 text-sm">write product information.</span>

  <ng-container [formGroup]="formGroup">
    <div class="flex items-center gap-4 mb-2">
      <label for="nameP" class="font-semibold w-24 text-sm">Name</label>
      <input pInputText id="nameP" class="flex-auto" autocomplete="off" pSize="small"
        formControlName="name" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.name.touched && formGroup.controls.name.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }
    </div>

    <div class="flex items-center gap-4 mb-2">
      <label for="unitP" class="font-semibold w-24 text-sm">Unit price</label>
      <input pInputText id="unitP" class="flex-auto" autocomplete="off" type="number" pSize="small"
        formControlName="unitPrice" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.unitPrice.touched && formGroup.controls.unitPrice.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }
    </div>

    <div class="flex items-center gap-4 mb-2">
      <label for="unitStockP" class="font-semibold w-24 text-sm">Units in stock</label>
      <input pInputText id="unitStockP" class="flex-auto" autocomplete="off" type="number" pSize="small"
        formControlName="unitsInStock" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.unitsInStock.touched && formGroup.controls.unitsInStock.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }
    </div>

    <div class="flex items-center gap-4 mb-2">
      <label for="quantityP" class="font-semibold w-24 text-sm">Quantity per unit</label>
      <input pInputText id="quantityP" class="flex-auto" autocomplete="off" type="number" pSize="small"
        formControlName="quantityPerUnit" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.quantityPerUnit.touched && formGroup.controls.quantityPerUnit.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }
    </div>

    <div class="flex items-center gap-4 mb-2">
      <label for="cateP" class="font-semibold w-24 text-sm">Category</label>
      <p-select [options]="categories" optionLabel="name" optionValue="id" placeholder="Select a category" size="small" class="flex-auto"
        formControlName="categoryId" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.categoryId.touched && formGroup.controls.categoryId.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }
    </div>

    <div class="flex items-center gap-4 mb-2">
      <label for="fileP" class="font-semibold w-24 text-sm">Image</label>
      <input pInputText id="fileP" class="flex-auto" autocomplete="off" type="file" pSize="small"
        formControlName="image"
        (change)="onFileSelected($event)" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label class="w-24"></label>

      @if (formGroup.controls.image.touched && formGroup.controls.image.hasError('required')) {
        <small class="text-red-500">The field is required</small>
      }

      @if (imageFileError) {
        <small class="text-red-500">Image format invalid or size not allowed</small>
      }
  </div>

    <div class="flex items-center gap-4 mb-8">
      <label for="disP" class="font-semibold w-24 text-sm">Discontinued?</label>
      <p-toggleswitch inputId="disP" formControlName="discontinued" />
    </div>

    <div class="flex justify-end gap-2">
      <p-button label="Cancel" severity="secondary" (click)="closeModal()" size="small" />
      <p-button label="Save"
        severity="success"
        (click)="createProduct()"
        size="small"
        [disabled]="formGroup.invalid"
        [loading]="loading" />
    </div>
  </ng-container>
</p-dialog>

<p-toast />
